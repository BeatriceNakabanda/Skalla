{"remainingRequest":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/vue-loader/lib/index.js??vue-loader-options!/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/src/views/Login.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/src/views/Login.vue","mtime":1579980148902},{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/beatrice/AA5A6A6A5A6A336D1/templates/1/new/Estimation-System/skalla_client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#signin {\n  /* margin-left: -15px; */\n  padding: 4px 16px;\n}\n.text-danger {\n  color: #dc3545 !important;\n}\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6JA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n        <div class=\"row justify-content-center\">\n        <div class=\"col-lg-5 col-md-7\">\n            <div class=\"card bg-secondary shadow border-0\">\n                <div class=\"card-header bg-transparent pb-0\">\n                    <div class=\"text-muted text-center mt-2 mb-3\"><small>Sign in with credentials</small></div>\n                </div>\n                <div class=\"card-body px-lg-5 py-lg-3\">\n                    <form method=\"POST\" role=\"form\" class=\"mb-1\" @submit.prevent=\"signIn\">\n                        <base-input class=\"input-group-alternative mb-3\"\n                                    placeholder=\"Email\"\n                                    addon-left-icon=\"ni ni-circle-08\"\n                                    v-model=\"credentials.email\"\n                                    :class=\"{ }\" \n                                    type=\"email\"\n                                    >\n                        </base-input>\n                        <div class=\"text-danger\">{{ errors.email }}</div>\n\n                        <base-input class=\"input-group-alternative\"\n                                    placeholder=\"Password\"\n                                    type=\"password\"\n                                    addon-left-icon=\"ni ni-lock-circle-open\"\n                                    v-model=\"credentials.password\"\n                                    :class=\"{  } \"\n                                    >\n                        </base-input>\n                        <div class=\"text-danger\">{{ errors.password }}</div>\n\n                        <base-checkbox class=\"custom-control-alternative text-left\" >\n                            <span class=\"text-muted\">Remember me</span>\n                        </base-checkbox>\n\n            <div class=\"text-center\">\n              <base-button\n                type=\"primary\"\n                class=\"shadow-none mt-3 mb-2 px-5 mx-7\"\n                id=\"signin\"\n                @click=\"signIn\"\n                >Sign in</base-button\n              >\n                  <p class=\"text-danger\" v-if=\"msg\">{{ msg }}</p>\n            </div>\n            </form>\n                </div>\n            </div>\n        </div>\n      </div>\n</template>\n<script>\nimport router from \"../router\";\nimport AuthService from \"../services/AuthService\";\n// import store from \"../store\";\n\n// Validating email and password\nconst validateEmail = email => {\n  if (!email.length) {\n    return { valid: false, error: \"Email is required\" };\n  }\n  if (!email.match(/^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(.\\w{2,3})+$/)) {\n    return { valid: false, error: \"Please, enter a valid email.\" };\n  }\n  return { valid: true, error: null };\n};\n\nconst validatePassword = password => {\n  if (!password.length) {\n    return { valid: false, error: \"Password is required\" };\n  }\n  if (password.length < 6) {\n    return { valid: false, error: \"Password is too short\" };\n  }\n  return { valid: true, error: null };\n};\n\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      // error: false,\n      // submitting: false,\n      // success: false,\n      credentials: {\n        email: \"\",\n        password: \"\"\n      },\n      valid: true,\n      success: false,\n      errors: {},\n      message: null,\n      msg: \"\"\n    };\n  },\n  methods: {\n    async signIn() {\n      try {\n        this.errors = {};\n        //Validating input fields\n        const validEmail = validateEmail(this.credentials.email);\n        this.errors.email = validEmail.error;\n        if (this.valid) {\n          this.valid = validEmail.valid;\n        }\n        const validPassword = validatePassword(this.credentials.password);\n        this.errors.password = validPassword.error;\n        if (this.valid) {\n          this.valid = validPassword.valid;\n        }\n        //sending captured data to the server\n      \n        const response = await AuthService.login(this.credentials);\n\n        const token = response.token;\n        const user = response.user;\n        const role = response.user.role;\n\n        // const email = response.email\n\n        // console.log(response);\n\n        //console.log(role)\n\n              this.$store.dispatch('login', { token, user});\n              \n\n                // const role = response.data.role\n                // console.log(role)\n                if(role === 'Developer'){\n                  router.push('/pending-estimates')\n                }else if(role === 'Project Manager'){\n                  router.push('/estimates')\n                }\n       }catch (error) {\n              \n              this.msg = 'Wrong email or password'\n              \n            }\n\n\n      \n    }\n\n    // const role = response.data.role\n    // console.log(role)\n    // if(role === 'Developer'){\n    //   router.push('/pendingEstimates')\n    // }else if(role === 'Project Manager'){\n    //   router.push('/estimates')\n    // }\n    // })\n    // .catch((error) => {\n    //     console.log(error);\n    // });\n  }\n};\n</script>\n<style>\n#signin {\n  /* margin-left: -15px; */\n  padding: 4px 16px;\n}\n.text-danger {\n  color: #dc3545 !important;\n}\n</style>\n"]}]}